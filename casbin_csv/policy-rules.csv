p, "upload_submission" == r.action.type, r.subject.authenticated, r.subject.role == "student", "*", r.course.published, not(r.course.in_trash), ((r.lab.start <= r.action.time) && (r.action.time <= r.lab.end)), r.lab.visible, not(r.lab.in_trash), r.subject.is_ip_in_range, r.program.visible, not(r.program.in_trash), allow
p, "upload_submission" == r.action.type, r.subject.authenticated, r.subject.role == "instructor", r.subject.mode == "STUDENT", r.course.published, not(r.course.in_trash), ((r.lab.start <= r.action.time) && (r.action.time <= r.lab.end)), r.lab.visible, not(r.lab.in_trash), r.subject.is_ip_in_range, r.program.visible, not(r.program.in_trash), allow
p, "upload_submission" == r.action.type, r.subject.authenticated, r.subject.role == "instructor", r.subject.mode == "TEST_DRIVE", "*", not(r.course.in_trash), "*", "*", not(r.lab.in_trash), "*", "*", not(r.program.in_trash), allow
