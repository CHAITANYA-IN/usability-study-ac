p, "upload_submission" == r.action.type, r.user.authenticated, r.user.role == "student", "*", r.course.published, not(r.course.trashed), ((r.lab.start <= r.action.time) && (r.action.time <= r.lab.end)), r.lab.visible, not(r.lab.trashed), r.user.is_ip_in_range, r.program.visible, not(r.program.trashed), allow
p, "upload_submission" == r.action.type, r.user.authenticated, r.user.role == "instructor", r.user.mode == "STUDENT", r.course.published, not(r.course.trashed), ((r.lab.start <= r.action.time) && (r.action.time <= r.lab.end)), r.lab.visible, not(r.lab.trashed), r.user.is_ip_in_range, r.program.visible, not(r.program.trashed), allow
p, "upload_submission" == r.action.type, r.user.authenticated, r.user.role == "instructor", r.user.mode == "TEST_DRIVE", "*", not(r.course.trashed), "*", "*", not(r.lab.trashed), "*", "*", not(r.program.trashed), allow
